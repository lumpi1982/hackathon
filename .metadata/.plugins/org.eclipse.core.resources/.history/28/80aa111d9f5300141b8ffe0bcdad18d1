var express = require('express');
var app = express();
// This make a uri end point for the REST call
// http://myhost/emp will return the data
app.get('/cardinfo', function(req, res){
  console.log('Received request: serialno=', req.query['serialno']);
  fetchSerialNoInfo(req,res);
  }
);

var databaseUrl = "mongouser:Password1@localhost/mydb"; // "username:password@example.com/mydb"
var collections = ["users", "reports"]
var db = require("mongojs").connect(databaseUrl, collections);

 
// function registered in the /emp declaration
function fetchSerialNoInfo(req,res){
	// app.js
	db.users.find({sex: "female"}, function(err, users) {
	  if( err || !users) console.log("No female users found");
	  else users.forEach( function(femaleUser) {
	    console.log(femaleUser);
	    res.write(JSON.stringify(femaleUser));
	    res.end();
	  } );
	});

}
 
// listen on port 8000
app.listen(8000);
